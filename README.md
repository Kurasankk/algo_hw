# algo_hw

**Анализ химерных ДНК-последовательностей с помощью скрытой марковской модели (HMM) и алгоритма Витерби.**

Этот проект позволяет:
- Генерировать химерные последовательности из двух исходных геномов с разным GC-составом.
- Декодировать последовательность, определяя, к какому геному принадлежит каждый нуклеотид, с помощью HMM и алгоритма Витерби.
- Оценивать точность предсказаний по сравнению с истинными метками.

Проект написан на Python 3 и использует библиотеки **Biopython** и **numpy**.

## Установка

1. Клонируем репозиторий:
```bash
git clone https://github.com/Kurasankk/algo_hw.git
cd algo_hw
```

## Использование

Генерация химерной последовательности

```bash
python algo_hw1.py \
  --genome_low Streptomyces.fasta \
  --genome_high Clostridium.fasta \
  --chimera \
  --length 10000 \
  --avg_fragment 300 \
  --verbose
```

Результат:

chimera.fasta — сгенерированная химерная последовательность.
chimera_true_labels.txt — истинные метки для каждого нуклеотида.
Декодирование химерной последовательности

```bash
python algo_hw1.py \
  --genome_low Streptomyces.fasta \
  --genome_high Clostridium.fasta \
  --input chimera.fasta \
  --true_labels chimera_true_labels.txt \
  --output chimera_pred.txt \
  --avg_fragment 300 \
  --verbose
```
Результат:

chimera_pred.txt — предсказанные состояния для каждого нуклеотида.
В консоли выводится точность предсказаний.

## Параметры скрипта

| Параметр | Описание |
|----------|----------|
| `--genome_low` | FASTA-файл генома с низким GC |
| `--genome_high` | FASTA-файл генома с высоким GC |
| `--chimera` | Флаг генерации химерной последовательности |
| `--length` | Длина химерной последовательности (по умолчанию: 10000) |
| `--avg_fragment` | Средняя длина фрагмента (по умолчанию: 300) |
| `--input` | Входная последовательность для декодирования |
| `--true_labels` | Файл с истинными метками для оценки точности |
| `--output` | Файл для сохранения предсказаний |
| `--verbose` | Подробный вывод работы скрипта |

## Алгоритмическая основа

Скрытая марковская модель (HMM)

Скрытые состояния:

0 — фрагмент из генома с низким GC
1 — фрагмент из генома с высоким GC
Наблюдения: нуклеотиды A, T, G, C
Эмиссионные вероятности: оцениваются на основе GC-состава исходных геномов

## Алгоритм Витерби

Используется для нахождения наиболее вероятной последовательности скрытых состояний:

```python

# Псевдокод
1. Инициализация: V[0][state] = log(start_prob[state]) + log(emit_prob[state][obs[0]])
2. Рекурсия: V[t][state] = max(V[t-1][prev_state] + log(trans_prob[prev_state][state])) + log(emit_prob[state][obs[t]])
3. Терминация: best_path = argmax(V[T-1][state])
4. Обратный ход: восстановление оптимального пути

```

## Формат файлов

1. Входные FASTA-файлы

```text
>sequence_name
ATCGATCGATCGATCG...
```

2. Файл с метками (_true_labels.txt)

```text
0
0
0
1
1
1
0
...
```

Где:

0 — нуклеотид из генома с низким GC
1 — нуклеотид из генома с высоким GC
3. Файл с предсказаниями (_pred.txt)

Аналогичный формат с предсказанными метками (0 или 1)

## Примечания и ограничения

Минимальная длина фрагмента: 50 нуклеотидов при генерации химерной последовательности
Стабильность вычислений: Алгоритм Витерби использует логарифмы вероятностей для избежания численных проблем
Предположения модели:

GC-состав геномов существенно различается
Переходы между фрагментами равновероятны в обоих направлениях
Длины фрагментов распределены экспоненциально
Требования к данным: FASTA-файлы должны содержать валидные последовательности ДНК (только символы A, T, G, C, N)

## Оценка точности

Точность вычисляется по формуле:

```text
Accuracy = (Число правильно предсказанных нуклеотидов) / (Общее число нуклеотидов) * 100%
```
Пример вывода:

```text
Точность предсказаний: 92.34%
```

## Устранение неполадок

| Проблема | Возможное решение |
|----------|-------------------|
| "ModuleNotFoundError: No module named 'Bio'" | Установите biopython: `pip install biopython` |
| "File not found" | Проверьте правильность путей к файлам |
| Низкая точность предсказаний | Убедитесь, что GC-состав геномов существенно различается |
| Долгое выполнение для длинных последовательностей | Уменьшите параметр `--length` |
| Предупреждения о делении на ноль | Проверьте входные FASTA-файлы на корректность |
